# Edit this file to configure debian/rules to build a package.
# No modification of debian/rules should be neccessary. (Famous last words!)
#
# File by Joey Hess <jeh22@cornell.edu>
# Modified for trn 3.6-7 by Jon Rabone <jkr@debian.org>

# What is the name of this package?
package=trn

# Files that go in directories under /doc.
docs=
examples=
copyright=debian/copyright

# List here all executables that are produced, that we should run
# dpkg-shlibdeps on.
binfiles=$(package)

# What file must exist in the current directory if the package is
# properly unpacked here?
test_file=$(package).c

# Does this package build from an Imakefile?
# If so, uncomment the line below.
#use_imakefile=y

# Does this package build from a Configure script?
# If so, uncomment the line below and enter the command to run to run the 
# Configure script (ie: "./Configure")
# 
# Don't reconfigure trn 3.6 unless you know what you're doing. 
# I've had problems getting certain things to work, e.g. strftime detection
# JKR 1996
# I'll comment it out then ;) Matthew@debian.org 1999
#use_configure=./Configure -S

# What commands to run to build the package?
define build_command
	$(MAKE)
endef

# What commands to run to clean up after a build?
define clean_command
	$(MAKE) -i clean
endef

# List here any files that must be removed during "debian/rules clean"
# that clean_command doesn't take care of.
clean_files=

# List here any files that should be preserved during a build, and restored
# to their original state during a clean. For example, if the package comes
# with both an Imakefile and a Makefile, and xmkmf is run, list the original
# Makefile here so it will be backed up before it is overwritten my xmkmf.
preserve_files=

# What command to run to install the package into debian/tmp?
# You might want to edit the package's Makefile and add $(PREFIX) 
# to all the paths it installs files to. or, you can just write 
# your own install commands here instead.
#
# Note that debian/* and the files in /usr/doc will be installed 
# properly for you, you don't need to do that here.
#
define install_command
	install -d debian/tmp/usr/bin
	ln -s ../lib/trn/trn debian/tmp/usr/bin/trn3
	install -d debian/tmp/usr/lib/trn
        install -s trn debian/tmp/usr/lib/trn
        install -s trn-artchk debian/tmp/usr/lib/trn
        install -s nntplist debian/tmp/usr/lib/trn
        install newsetup debian/tmp/usr/lib/trn
        install newsgroups debian/tmp/usr/lib/trn
        install Pnews debian/tmp/usr/lib/trn
        install Rnmail debian/tmp/usr/lib/trn
        ln -s trn debian/tmp/usr/lib/trn/rn
        install -d debian/tmp/usr/share/trn     
        install -m 0644 INIT debian/tmp/usr/share/trn   
        install -m 0644 newsnews debian/tmp/usr/share/trn       
        install -m 0755 Pnews.header debian/tmp/usr/share/trn   
        install -m 0755 Speller debian/tmp/usr/share/trn        
        install -m 0755 filexp debian/tmp/usr/share/trn 
        install -m 0755 makedir debian/tmp/usr/share/trn        
        install -m 0755 mbox.saver debian/tmp/usr/share/trn     
        install -m 0755 norm.saver debian/tmp/usr/share/trn     
        install -d debian/tmp/usr/share/man/man1
        cp -f Pnews.1 debian/tmp/usr/share/man/man1/trn3-Pnews.1
        cp -f Rnmail.1 debian/tmp/usr/share/man/man1/trn3-Rnmail.1
        cp -f newsetup.1 debian/tmp/usr/share/man/man1/trn3-newsetup.1
        cp -f newsgroups.1 debian/tmp/usr/share/man/man1/trn3-newsgroups.1
	cp -f nntplist.1 debian/tmp/usr/share/man/man1/trn3-nntplist.1
	cp -f trn-artchk.1 debian/tmp/usr/share/man/man1/trn3-trn-artchk.1
        cp -f trn.1 debian/tmp/usr/share/man/man1/trn3.1
        cp -f HINTS.TRN debian/tmp/usr/share/doc/trn/trn-hints
        cp -f NEW debian/tmp/usr/share/doc/trn/trn-changes
        gzip -9vf debian/tmp/usr/share/doc/trn/trn-changes
        cp -f README debian/tmp/usr/share/doc/trn/trn-readme
	install -m 755 debian/config.debconf debian/tmp/DEBIAN/config
	cp -f debian/templates debian/tmp/DEBIAN/
endef

# After being installed in debian/tmp, everything is chowned to root.root,
# and chmod g-ws is run on everything. Enter below any chmod commands you
# need to run to set files to the proper permissions. This is where you
# can make programs be suid, etc.
# (Note that these commands will be run as root.)
define ch_commands
	chown -R root.news debian/tmp/usr/share/trn
endef
